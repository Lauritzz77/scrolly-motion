var T=Object.defineProperty,F=(c,e,t)=>e in c?T(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t,u=(c,e,t)=>(F(c,typeof e!="symbol"?e+"":e,t),t);const Y={breakpoints:{default:"(min-width: 1px)",mobile:"(max-width: 767px)",tablet:"(min-width: 768px) and (max-width: 1023px)",desktop:"(min-width: 1024px)"}},_={enterClassNames:[],leaveClassNames:[]},x={enter:"10vh",exit:"40vh",once:!1,damping:0,friction:.95},v={maxDeltaTime:16.67,scrollStopDelay:100,minProgressDiff:.001,minVelocity:.001,attractionForce:.015,velocityScale:.8},M=["large","desktop","tablet","mobile","default"];function O(c,e){let t;return function(...s){clearTimeout(t),t=setTimeout(()=>c.apply(this,s),e)}}function b(c,e){return c?c.trim().replace(/^['"]|['"]$/g,"").split(/\s+/).filter(Boolean):e}function S(c,e){if(typeof c=="number")return c>0&&c<1?c*e:c;if(typeof c=="string"){const t=c.match(/^(-?[\d.]+)(vh|px|%)$/);if(t){const s=parseFloat(t[1]),a=t[2];if(a==="%"||a==="vh")return e*(s/100);if(a==="px")return s}}return 0}function N(c){const e=new Map;return Object.entries(c).forEach(([t,s])=>{const a=window.matchMedia(s);e.set(t,a)}),e}function z(c){const e=[],t=[],s={...c};if(c.selector&&typeof c.selector!="string"&&e.push("`selector` must be a string."),c.defaultEnter&&typeof c.defaultEnter!="string"&&e.push("`defaultEnter` must be a string."),c.breakpoints)if(typeof c.breakpoints!="object"||c.breakpoints===null)e.push("`breakpoints` must be an object.");else for(const a in c.breakpoints)typeof c.breakpoints[a]!="string"&&t.push(`Breakpoint \`${a}\` has an invalid value. It must be a string.`);if(c.presets)if(typeof c.presets!="object"||c.presets===null)e.push("`presets` must be an object.");else for(const a in c.presets)Array.isArray(c.presets[a])||t.push(`Preset \`${a}\` has an invalid value. It must be an array of TimelineStep objects.`);return{isValid:e.length===0,errors:e,warnings:t,sanitizedConfig:s}}class P{constructor(e){u(this,"valueParser"),this.valueParser=e}parse(e){try{const t=[];return e.split(";").forEach(s=>{const a=s.trim(),n=a.indexOf(":");if(n===-1)return;const l=a.substring(0,n),r=a.substring(n+1);let i;if(l==="from")i=0;else if(l==="to")i=1;else if(l.startsWith("via-")&&l.endsWith("%")){const p=l.substring(4,l.length-1),g=parseFloat(p);if(isNaN(g))return;i=g/100}else if(i=parseFloat(l),isNaN(i))return;const o={};r.split("|").forEach(p=>{if(p.startsWith("letter-spacing")){const f=p.substring(15);o["letter-spacing"]=this.valueParser.parse("letter-spacing",f);return}const g=p.indexOf("-");if(g>0){const f=p.substring(0,g);let h=p.substring(g+1);h.startsWith("-")&&(h=h),f&&h!==void 0&&(o[f]=this.valueParser.parse(f,h))}}),t.push({at:i,properties:o})}),t.sort((s,a)=>s.at-a.at)}catch(t){return console.error(`ScrollyMotion: Failed to parse timeline: "${e}"`,t),[]}}}class A{constructor(e){u(this,"pluginManager"),this.pluginManager=e}parse(e,t){try{const s=this.pluginManager.parse(e,t);return s!==void 0?s:t.startsWith("[")&&t.endsWith("]")?this.parseArbitraryValue(e,t.slice(1,-1)):this.parseTailwindValue(e,t)}catch(s){return console.error(`ScrollyMotion: Failed to parse value for property "${e}": "${t}"`,s),t}}parseArbitraryValue(e,t){if(e.includes("translate")||e.includes("scale")||e.includes("rotate")||e.includes("blur")||e.includes("grayscale")||e.includes("skew")||e.includes("perspective")){if(/^-?[\d.]+[a-z%]+$/i.test(t))return t;if(/^-?[\d.]+$/.test(t)){const s=parseFloat(t);return e.includes("rotate")?`${s}deg`:e.includes("scale")?s:`${s}px`}}return e==="opacity"?parseFloat(t):t}parseTailwindValue(e,t){if(e.includes("translate"))return this.parseTailwindSpacing(t);if(e==="opacity")return this.parseTailwindOpacity(t);if(e.includes("scale"))return this.parseTailwindScale(t);if(e.includes("rotate"))return this.parseTailwindRotate(t);if(e.includes("blur"))return this.parseTailwindBlur(t);if(e.includes("grayscale"))return this.parseTailwindGrayscale(t);if(e.includes("skew"))return this.parseTailwindSkew(t);if(e.includes("perspective"))return this.parseTailwindPerspective(t);const s=parseFloat(t);return isNaN(s)?t:s}parseTailwindSpacing(e){const t=parseFloat(e);return isNaN(t)?0:t*4}parseTailwindOpacity(e){const t=parseFloat(e);return isNaN(t)?0:t*.01}parseTailwindScale(e){const t=parseFloat(e);return isNaN(t)?1:t*.01}parseTailwindRotate(e){const t=parseFloat(e);return isNaN(t)?0:t}parseTailwindBlur(e){const t=parseFloat(e);return isNaN(t)?0:t*4}parseTailwindGrayscale(e){const t=parseFloat(e);return isNaN(t)?0:t*.01}parseTailwindSkew(e){const t=parseFloat(e);return isNaN(t)?0:t}parseTailwindPerspective(e){const t=parseFloat(e);return isNaN(t)?0:t}}class I{constructor(e,t,s){u(this,"timelinePresets"),u(this,"mediaQueries"),u(this,"timelineParser"),u(this,"valueParser"),this.timelinePresets=e,this.mediaQueries=t,this.valueParser=new A(s),this.timelineParser=new P(this.valueParser)}parse(e){if(!e)return null;const t=this.parseBreakpoints(e),s=this.getActiveConfig(t);if(!s)return null;const a=e.match(/transition-duration-(\d+)/);a&&(s.transitionDuration=parseInt(a[1],10));const n=e.match(/transition-easing-([a-zA-Z-]+)/);return n&&(s.transitionEasing=n[1]),s}parseBreakpoints(e){const t={};return e.trim().split(/(?=@)/).forEach(s=>{const a=s.trim();if(!a)return;let n="default",l=a;if(a.startsWith("@")){const r=a.indexOf(":");r>-1&&(n=a.substring(1,r),l=a.substring(r+1))}t[n]||(t[n]={from:{},to:{},breakpoint:n}),this.processConfig(n,l,t)}),t}processConfig(e,t,s){if(s[e]||(s[e]={from:{},to:{},breakpoint:e}),t.includes(";")&&(t.includes("from:")||t.includes("via-")||t.includes("to:"))){s[e].timeline=this.timelineParser.parse(t);return}(t.includes(";")?t.split(";").map(a=>a.trim()):[t.trim()]).forEach(a=>{a&&this.parsePart(a,s[e])})}parsePart(e,t){try{e.split(/\s+(?=(?:from|to|timeline|preset):)/).forEach(s=>{const a=s.trim();if(a.startsWith("from:")){const n=a.substring(5);this.parseProps(n,t.from)}else if(a.startsWith("to:")){const n=a.substring(3);this.parseProps(n,t.to)}else if(a.startsWith("timeline:")){const n=a.substring(9);t.timeline=this.timelineParser.parse(n)}else if(a.startsWith("preset:")){const n=a.substring(7).trim(),l=this.timelinePresets.get(n);l?t.timeline=l:console.warn(`ScrollyMotion: Unknown preset: ${n}`)}})}catch(s){console.error(`ScrollyMotion: Failed to parse animation part: "${e}"`,s)}}parseProps(e,t){try{e.split("|").forEach(s=>{if(s.startsWith("letter-spacing")){const n=s.substring(15);t["letter-spacing"]=this.valueParser.parse("letter-spacing",n);return}const a=s.indexOf("-");if(a>0){const n=s.substring(0,a);let l=s.substring(a+1);l.startsWith("-")&&(l=l),n&&l!==void 0&&(t[n]=this.valueParser.parse(n,l))}})}catch(s){console.error(`ScrollyMotion: Failed to parse properties: "${e}"`,s)}}getActiveConfig(e){for(const t of M)if(e[t]){const s=this.mediaQueries.get(t);if(s&&s.matches)return e[t]}return e.default||null}}class j{constructor(e){u(this,"timelineParser"),u(this,"valueParser"),this.valueParser=new A(e),this.timelineParser=new P(this.valueParser)}parse(e){if(!e)return null;try{const t=e.match(/transition-duration-(\d+)/),s=e.match(/transition-easing-([a-zA-Z-]+)/),a=e.match(/^\[([^\]]+)\]:/);if(!a)return null;let n=a[1];n.startsWith("&")&&(n=n.substring(1));const l=e.substring(a[0].length),r={selector:n,from:{},to:{},staggerDelay:.1,breakpoint:"default",transitionDuration:t?parseInt(t[1],10):void 0,transitionEasing:s?s[1]:void 0};if(l.includes(";")&&(l.includes("from:")||l.includes("via-")||l.includes("to:"))||l.includes("via-"))this.processSection("timeline",l,r);else if(l.startsWith("timeline:")){const i=l.substring(9);this.processSection("timeline",i,r)}else{const i=l.split(":");let o="",p="";i.forEach(g=>{g==="from"||g==="to"?(o&&p&&this.processSection(o,p,r),o=g,p=""):(p&&(p+=":"),p+=g)}),o&&p&&this.processSection(o,p,r)}return r}catch(t){return console.error(`ScrollyMotion: Failed to parse stagger animation: "${e}"`,t),null}}parseMultiBreakpoint(e){var t;try{const s={},a=/(@[^:]+:)/g,n=e.split(a).filter(Boolean);let l="default";for(let r=0;r<n.length;r++){const i=n[r].trim();if(i.startsWith("@")&&i.endsWith(":")){l=i.slice(1,-1);const o=(t=n[r+1])==null?void 0:t.trim();if(o){const p=this.parse(o);p&&(s[l]=p),r++}}else{const o=this.parse(i);o&&(s.default=o)}}return s}catch(s){return console.error(`ScrollyMotion: Failed to parse multi-breakpoint stagger animation: "${e}"`,s),{}}}processSection(e,t,s){if(e==="from"||e==="to")t.split("|").forEach(a=>{if(a.startsWith("stagger-"))s.staggerDelay=parseFloat(a.substring(8))||.1;else{const n=a.indexOf("-");if(n>0){const l=a.substring(0,n),r=a.substring(n+1);if(l&&r!==void 0){const i=e==="from"?s.from:s.to;i[l]=this.valueParser.parse(l,r)}}}});else if(e==="timeline"){let a=t,n=.1,l;t.includes(";")?l=t.split(";"):l=t.split(/\s+(?=(?:from:|via-|to:))/);const r=[];l.forEach(i=>{const o=i.trim();if(o.includes("|stagger-")){const p=o.split("|"),g=p.find(h=>h.startsWith("stagger-"));g&&(n=parseFloat(g.substring(8))||.1);const f=p.filter(h=>!h.startsWith("stagger-"));r.push(f.join("|"))}else r.push(o)}),s.staggerDelay=n,a=r.join("; "),s.timeline=this.timelineParser.parse(a)}}}class V{constructor(e,t,s){u(this,"animationParser"),u(this,"staggerParser"),this.animationParser=new I(e,t,s),this.staggerParser=new j(s)}parseAnimation(e){try{return this.animationParser.parse(e)}catch(t){return console.error("Failed to parse animation:",t),null}}parseStaggerAnimation(e,t="default"){try{return this.staggerParser.parse(e)}catch(s){return console.error("Failed to parse stagger animation:",s),null}}parseMultiBreakpointStagger(e){try{return this.staggerParser.parseMultiBreakpoint(e)}catch(t){return console.error("Failed to parse multi-breakpoint stagger animation:",t),{}}}}class ${updateAnimation(e,t){if(!e._animationConfig)return;const{from:s,to:a,timeline:n}=e._animationConfig;if(n&&n.length>0){const r=this.calculateTimelineValues(n,t);this.applyAnimationValues(e,r);return}const l={};new Set([...Object.keys(s),...Object.keys(a)]).forEach(r=>{const i=s[r],o=a[r];if(i!==void 0&&o!==void 0)if(typeof i=="number"&&typeof o=="number")l[r]=i+(o-i)*t;else if(typeof i=="string"&&typeof o=="string"){const p=i.match(/^(-?[\d.]+)([a-z%]+)$/i),g=o.match(/^(-?[\d.]+)([a-z%]+)$/i);if(p&&g&&p[2]===g[2]){const f=parseFloat(p[1]),h=parseFloat(g[1]),m=f+(h-f)*t;l[r]=m+p[2]}else l[r]=t<.5?i:o}else l[r]=t<.5?i:o;else if(i!==void 0&&o===void 0){const p=r==="opacity"?1:0;typeof i=="number"?l[r]=i+(p-i)*t:l[r]=i}else i===void 0&&o!==void 0&&(typeof o=="number"?l[r]=0+(o-0)*t:l[r]=t>0?o:void 0)}),this.applyAnimationValues(e,l)}calculateTimelineValues(e,t){const s={};let a=null,n=null;for(let l=0;l<e.length;l++){const r=e[l];if(t>=r.at)a=r,n=e[l+1]||null;else break}if(a||(a=e[0],n=e[1]||null),n&&t>a.at){const l=(t-a.at)/(n.at-a.at);new Set([...Object.keys(a.properties),...Object.keys(n.properties)]).forEach(r=>{const i=a.properties[r],o=n.properties[r];if(i!==void 0&&o!==void 0)if(typeof i=="number"&&typeof o=="number")s[r]=i+(o-i)*l;else if(typeof i=="string"&&typeof o=="string"){const p=i.match(/^(-?[\d.]+)([a-z%]+)$/i),g=o.match(/^(-?[\d.]+)([a-z%]+)$/i);if(p&&g&&p[2]===g[2]){const f=parseFloat(p[1]),h=parseFloat(g[1]),m=f+(h-f)*l;s[r]=m+p[2]}else s[r]=l<.5?i:o}else s[r]=l<.5?i:o;else i!==void 0?s[r]=i:o!==void 0&&(s[r]=l>0?o:void 0)})}else Object.assign(s,a.properties);return s}updateStaggerAnimation(e,t){if(!e._staggerConfig||e._staggerChildren.length===0)return;const{from:s,to:a,staggerDelay:n,timeline:l}=e._staggerConfig,r=e._staggerChildren.length,i=(r-1)*n;e._staggerChildren.forEach((o,p)=>{let g=0;if(t>0){const h=p*n/(1+i),m=h+1/(1+i);t>=h&&(g=Math.min(1,(t-h)/(m-h)))}else if(t<0&&!e._once){const h=(r-1-p)*n/(1+i),m=h+1/(1+i),d=Math.abs(t);d>=h?g=1-Math.min(1,(d-h)/(m-h)):g=1}let f={};l&&l.length>0?f=this.calculateTimelineValues(l,g):new Set([...Object.keys(s),...Object.keys(a)]).forEach(h=>{const m=s[h],d=a[h];if(m!==void 0&&d!==void 0)typeof m=="number"&&typeof d=="number"?f[h]=m+(d-m)*g:f[h]=g<.5?m:d;else if(m!==void 0){const y=h==="opacity"?1:0;typeof m=="number"?f[h]=m+(y-m)*g:f[h]=m}else d!==void 0&&(typeof d=="number"?f[h]=0+(d-0)*g:f[h]=g>0?d:void 0)}),this.applyAnimationValues(o,f)})}applyAnimationValues(e,t){const s=[],a=[];let n=!1,l=!1;if(Object.keys(t).forEach(r=>{const i=t[r];if(i!=null)if(r==="opacity")e.style.opacity=i.toString();else if(r==="translateX"){const o=typeof i=="string"&&i.match(/[a-z%]/i)?i:`${i}px`;s.push(`translateX(${o})`),n=!0}else if(r==="translateY"){const o=typeof i=="string"&&i.match(/[a-z%]/i)?i:`${i}px`;s.push(`translateY(${o})`),n=!0}else if(r==="translateZ"){const o=typeof i=="string"&&i.match(/[a-z%]/i)?i:`${i}px`;s.push(`translateZ(${o})`),n=!0}else if(r==="scale")s.push(`scale(${i})`),n=!0;else if(r==="scaleX")s.push(`scaleX(${i})`),n=!0;else if(r==="scaleY")s.push(`scaleY(${i})`),n=!0;else if(r==="rotate"){const o=typeof i=="string"&&i.match(/[a-z%]/i)?i:`${i}deg`;s.push(`rotate(${o})`),n=!0}else if(r==="rotateX"){const o=typeof i=="string"&&i.match(/[a-z%]/i)?i:`${i}deg`;s.push(`rotateX(${o})`),n=!0}else if(r==="rotateY"){const o=typeof i=="string"&&i.match(/[a-z%]/i)?i:`${i}deg`;s.push(`rotateY(${o})`),n=!0}else if(r==="rotateZ"){const o=typeof i=="string"&&i.match(/[a-z%]/i)?i:`${i}deg`;s.push(`rotateZ(${o})`),n=!0}else if(r==="skewX"){const o=typeof i=="string"&&i.match(/[a-z%]/i)?i:`${i}deg`;s.push(`skewX(${o})`),n=!0}else if(r==="skewY"){const o=typeof i=="string"&&i.match(/[a-z%]/i)?i:`${i}deg`;s.push(`skewY(${o})`),n=!0}else if(r==="blur"){const o=typeof i=="string"&&i.match(/[a-z%]/i)?i:`${i}px`;a.push(`blur(${o})`),l=!0}else if(r==="grayscale")a.push(`grayscale(${i})`),l=!0;else if(r==="perspective"){const o=typeof i=="string"&&i.match(/[a-z%]/i)?i:`${i}px`;e.style.perspective=o}else if(r==="letter-spacing"){const o=typeof i=="string"&&i.match(/[a-z%]/i)?i:`${i}px`;e.style.letterSpacing=o}else try{e.style[r]=i}catch(o){console.error(`Failed to apply style ${r}: ${i}`,o)}}),n){const r=s.join(" ");e.style.transform=r}if(l){const r=a.join(" ");e.style.filter=r}}}class D{constructor(){u(this,"animation"),u(this,"dampingAnimationId",null),u(this,"scrollStopTimer",null),u(this,"isScrolling",!1),u(this,"lastScrollTime",0),this.animation=new $}startDampingLoop(e){if(this.dampingAnimationId!==null)return;let t=performance.now();const s=a=>{const n=Math.min(a-t,v.maxDeltaTime);t=a;let l=!1;e.forEach(r=>{if(r._damping>0){const i=r._targetProgress,o=r._currentProgress,p=i-r._lastTargetProgress;if(r._lastTargetProgress=i,this.isScrolling){Math.abs(p)>.001&&(r._velocity=p*v.velocityScale);const h=1-r._damping;r._currentProgress=o*h+i*r._damping}else{r._currentProgress+=r._velocity*(n/v.maxDeltaTime);const h=Math.pow(r._friction,n/v.maxDeltaTime);r._velocity*=h;const m=(i-r._currentProgress)*v.attractionForce*(n/v.maxDeltaTime);r._velocity+=m}const g=Math.abs(i-o),f=Math.abs(r._velocity);g>v.minProgressDiff||f>v.minVelocity?(l=!0,r._currentProgress=Math.max(0,Math.min(1,r._currentProgress)),r._animationConfig&&this.animation.updateAnimation(r,r._currentProgress),r._staggerConfig&&r._staggerChildren.length>0&&this.animation.updateStaggerAnimation(r,r._currentProgress),r.style.setProperty("--element-progress",r._currentProgress.toFixed(3))):(r._velocity=0,r._currentProgress=i)}}),l?this.dampingAnimationId=requestAnimationFrame(s):this.dampingAnimationId=null};this.dampingAnimationId===null&&(this.dampingAnimationId=requestAnimationFrame(s))}onScroll(e){this.isScrolling=!0,this.lastScrollTime=performance.now(),this.scrollStopTimer&&clearTimeout(this.scrollStopTimer),this.scrollStopTimer=window.setTimeout(()=>{this.isScrolling=!1;const t=e.some(s=>s._damping>0);this.dampingAnimationId===null&&t&&this.startDampingLoop(e)},v.scrollStopDelay)}getScrollState(){return{isScrolling:this.isScrolling,lastScrollTime:this.lastScrollTime}}stopPhysics(){this.dampingAnimationId&&(cancelAnimationFrame(this.dampingAnimationId),this.dampingAnimationId=null),this.scrollStopTimer&&(clearTimeout(this.scrollStopTimer),this.scrollStopTimer=null),this.isScrolling=!1}getAnimation(){return this.animation}}class W{constructor(){u(this,"themedElements",new Map),u(this,"body",document.body)}registerElement(e,t){this.themedElements.set(e,{theme:t,inView:!1})}updateElementViewStatus(e,t){this.themedElements.has(e)&&(this.themedElements.get(e).inView=t),this.updateBodyTheme()}updateBodyTheme(){const e=Array.from(this.themedElements.values()).filter(t=>t.inView).map(t=>t.theme);e.length>0?this.body.setAttribute("data-theme",e[e.length-1]):this.body.removeAttribute("data-theme")}}const X=new Set(["translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skewX","skewY","perspective"]),B=new Set(["blur","grayscale"]);function L(c){const e=new Set;return c.timeline?c.timeline.forEach(t=>{Object.keys(t.properties).forEach(s=>e.add(s))}):("from"in c&&Object.keys(c.from).forEach(t=>e.add(t)),"to"in c&&Object.keys(c.to).forEach(t=>e.add(t))),e}function E(c,e=200,t="linear"){const s=L(c),a=new Set;let n=!1,l=!1;return s.forEach(r=>{X.has(r)?n=!0:B.has(r)?l=!0:a.add(`${r.replace(/([A-Z])/g,"-$1").toLowerCase()} ${e}ms ${t}`)}),n&&a.add(`transform ${e}ms ${t}`),l&&a.add(`filter ${e}ms ${t}`),Array.from(a).join(", ")}class Q{constructor(e,t,s,a,n){u(this,"elements"),u(this,"selector"),u(this,"config"),u(this,"parser"),u(this,"animation"),u(this,"themeManager"),u(this,"mediaQueries"),u(this,"intersectionObserver"),u(this,"activeElements",new Set),this.elements=new Map,this.selector=e.selector||"[data-scroll], [data-animation]",this.config=e,this.parser=t,this.animation=s,this.themeManager=a,this.mediaQueries=n,this.intersectionObserver=new IntersectionObserver(this.handleIntersection.bind(this),{rootMargin:"0px",threshold:0})}handleIntersection(e){e.forEach(t=>{const s=this.elements.get(t.target);s&&(t.isIntersecting?this.activeElements.add(s):this.activeElements.delete(s))})}discoverElements(){document.querySelectorAll(this.selector).forEach(e=>{this.elements.has(e)||(this.elements.set(e,e),this.intersectionObserver.observe(e))})}measureElements(){const e=window.innerHeight;this.elements.forEach(t=>{this._parseElementConfig(t,e),this._applyInitialStyles(t)})}_parseElementConfig(e,t){const s=window.scrollY||window.pageYOffset,a=e.getBoundingClientRect(),n=s+a.top,l=a.height,r=e.hasAttribute("data-scroll"),i=e.hasAttribute("data-animation"),o=(!r&&i?Object.entries(x).map(([m,d])=>`${m}:${d}`).join(";"):e.getAttribute("data-scroll")||"").split(/\s*;\s*/).reduce((m,d)=>{const[y,k]=d.split(/\s*:\s*/);if(!y)return m;let w=k;return w==="true"||w==="false"?w=w==="true":isNaN(w)||(w=parseFloat(w)),m[y]=w,m},{}),p=S(o.enter!=null?o.enter:this.config.defaultEnter,t),g=S(o.exit!=null?o.exit:0,t);let f;if(o.exit!=null&&o.distance==null){const m=n-(t-p);f=n+l-g-m}else f=S(o.distance!=null?o.distance:l,t);if(e._enterAt=n-(t-p),e._distance=f,e._exitAt=n+l-g,e._theme=o.theme,o.theme&&this.themeManager.registerElement(e,o.theme),e._once=o.once,e._enterClassNames=b(o.enterClass||o.class,_.enterClassNames),e._leaveClassNames=b(o.leaveClass,_.leaveClassNames),e._hasEnteredOnce=!1,!e._wcElements){const m=b(o.wc,[]);e._wcElements=m.flatMap(d=>Array.from(e.querySelectorAll(d)))}e._damping=o.damping,e._friction=o.friction,e._targetProgress=0,e._currentProgress=0,e._velocity=0,e._lastTargetProgress=0,e._isScrolling=!1;const h=e.getAttribute("data-animation");if(h){const m=h.includes(":[");h.includes("]:")?(e._multiStaggerConfig=this.parser.parseMultiBreakpointStagger(h),e._staggerConfig=this.getActiveStaggerConfig(e._multiStaggerConfig),e._animationConfig=null):m?(e._staggerConfig=this.parser.parseStaggerAnimation(h),e._animationConfig=null):(e._animationConfig=this.parser.parseAnimation(h),e._staggerConfig=null)}else e._animationConfig=null,e._staggerConfig=null;e._animeInstance=null,e._staggerChildren=[]}_applyInitialStyles(e){if(e._staggerConfig){const t=e._staggerConfig;if(!e._staggerChildren||e._staggerChildren.length===0){let s=[];if(t.selector.startsWith(">")){const a=t.selector.substring(1);s=Array.from(e.children).filter(n=>n.matches(a))}else s=Array.from(e.querySelectorAll(t.selector));e._staggerChildren=s,s.forEach(a=>{this.animation.applyAnimationValues(a,t.from);const n=E(t,t.transitionDuration,t.transitionEasing);n&&(a.style.transition=n)})}}if(e._animationConfig){const t=e._animationConfig;this.animation.applyAnimationValues(e,t.from);const s=E(t,t.transitionDuration,t.transitionEasing);s&&(e.style.transition=s)}}getElements(){return Array.from(this.elements.values())}getActiveElements(){return Array.from(this.activeElements)}destroy(){this.intersectionObserver.disconnect(),this.elements.clear()}getActiveStaggerConfig(e){if(!e)return null;for(const t of M)if(e[t]){const s=this.mediaQueries.get(t);if(s&&s.matches)return e[t]}return e.default||null}}class Z{constructor(){u(this,"events"),this.events=new Map}on(e,t){this.events.has(e)||this.events.set(e,new Set),this.events.get(e).add(t)}off(e,t){this.events.has(e)&&this.events.get(e).delete(t)}emit(e,...t){this.events.has(e)&&this.events.get(e).forEach(s=>{try{s(...t)}catch(a){console.error(`ScrollyMotion: Error in event handler for "${e}"`,a)}})}destroy(){this.events.clear()}}class q{constructor(){u(this,"plugins"),this.plugins=new Map}register(e){if(this.plugins.has(e.name)){console.warn(`ScrollyMotion: Plugin "${e.name}" is already registered.`);return}this.plugins.set(e.name,e)}getPlugin(e){return this.plugins.get(e)}parse(e,t){for(const s of this.plugins.values()){const a=s.parse(e,t);if(a!==void 0)return a}}destroy(){this.plugins.clear()}}class C{constructor(e={}){u(this,"prevScrollY"),u(this,"ticking"),u(this,"body"),u(this,"onResize"),u(this,"mediaQueries"),u(this,"parser"),u(this,"animation"),u(this,"physics"),u(this,"themeManager"),u(this,"elementManager"),u(this,"eventManager"),u(this,"pluginManager"),this.eventManager=new Z,this.pluginManager=new q;const{isValid:t,errors:s,warnings:a,sanitizedConfig:n}=z(e);if(a.length>0&&a.forEach(r=>console.warn(`ScrollyMotion: ${r}`)),!t)throw s.forEach(r=>console.error(`ScrollyMotion: ${r}`)),new Error("ScrollyMotion: Invalid configuration.");this.prevScrollY=0,this.ticking=!1,this.updateScroll=this.updateScroll.bind(this),this.onScroll=this.onScroll.bind(this),this.onResize=O(()=>{this.elementManager.measureElements(),this.updateScroll()},200),this.body=document.body,this.mediaQueries=N(n.breakpoints||Y.breakpoints);const l=this.initializePresets(n.presets);this.parser=new V(l,this.mediaQueries,this.pluginManager),this.animation=new $,this.physics=new D,this.themeManager=new W,this.elementManager=new Q(n,this.parser,this.animation,this.themeManager,this.mediaQueries),this.init()}destroy(){window.removeEventListener("resize",this.onResize),window.removeEventListener("scroll",this.onScroll),this.physics.stopPhysics(),this.elementManager.destroy(),this.eventManager.destroy(),this.pluginManager.destroy()}init(){const e=()=>{this.elementManager.discoverElements(),this.elementManager.getElements().length>0&&(this.elementManager.measureElements(),this.updateScroll(),setTimeout(()=>{this.updateScroll()},50),this.physics.startDampingLoop(this.elementManager.getElements()))};document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e(),window.addEventListener("resize",this.onResize),window.addEventListener("scroll",this.onScroll,{passive:!0})}onScroll(){this.physics.onScroll(this.elementManager.getActiveElements()),this.ticking||(window.requestAnimationFrame(this.updateScroll),this.ticking=!0)}updateScroll(){const e=window.scrollY||window.pageYOffset;let t="up";e>=300&&(t=e>this.prevScrollY?"down":"up"),this.body.setAttribute("data-scroll-direction",t),this.prevScrollY=e,this.elementManager.getActiveElements().forEach(s=>{const{_enterAt:a,_distance:n,_exitAt:l,_once:r,_damping:i}=s,o=Math.min(1,Math.max(0,(e-a)/n));s._targetProgress=o;let p=o;if(i>0){const m=1-i;s._currentProgress=s._currentProgress*m+o*i,p=s._currentProgress}else s._currentProgress=o;if(Math.abs(p-(s._lastProg||0))<.001&&i>0)return;s._lastProg=p,s.style.setProperty("--element-progress",p.toFixed(3));const g=p>0,f=e>l,h=g&&!f;s._theme&&this.themeManager.updateElementViewStatus(s,h),h?(s._hasEnteredOnce||this.eventManager.emit("elementEnter",s),s._hasEnteredOnce=!0,s._enterClassNames.forEach(m=>s.classList.add(m)),s._leaveClassNames.forEach(m=>s.classList.remove(m))):(s._hasEnteredOnce&&this.eventManager.emit("elementLeave",s),r&&s._hasEnteredOnce||(s._enterClassNames.forEach(m=>s.classList.remove(m)),s._leaveClassNames.forEach(m=>s.classList.add(m)))),s._animationConfig&&this.animation.updateAnimation(s,p),s._staggerConfig&&s._staggerChildren.length>0&&this.animation.updateStaggerAnimation(s,p),s._wcElements.forEach(m=>{const d=m;if(typeof d.progress=="function"&&d._lastProgress!==p&&(d.progress(p),d._lastProgress=p),typeof d.enter=="function"){const y=h;d._lastInView!==y&&(y&&typeof d.enter=="function"&&d.enter(),!y&&typeof d.leave=="function"&&d.leave(),d._lastInView=y)}})}),this.ticking=!1}on(e,t){this.eventManager.on(e,t)}registerPlugin(e){this.pluginManager.register(e)}initializePresets(e={}){const t=new Map;return Object.entries(e).forEach(([s,a])=>{t.set(s,a)}),t}getMetrics(){const{lastScrollTime:e}=this.physics.getScrollState(),t=performance.now(),s=e>0?Math.round(1e3/(t-e)):60,a=this.elementManager.getElements(),n=a.filter(i=>i._damping>0||i._animationConfig||i._staggerConfig).length,l=a.length*.5+n*1.2,r="transform"in document.createElement("div").style;return{fps:Math.min(s,60),activeElements:n,memoryUsage:l,gpuAccelerated:r}}}typeof window<"u"&&(window.ScrollyMotion=C,"IntersectionObserver"in window&&"requestAnimationFrame"in window&&"Map"in window&&"Set"in window?(console.log("ðŸš€ ScrollyMotion: Library loaded and ready!"),console.log("âœ… ScrollyMotion: Browser compatible")):console.warn("âŒ ScrollyMotion: Browser not compatible"));new C({selector:"[data-scroll], [data-animation]",defaultEnter:"20vh",presets:{fadeInUp:[{at:0,properties:{opacity:0,translateY:-50,scale:.8}},{at:.5,properties:{opacity:.7,translateY:-10,scale:.95}},{at:1,properties:{opacity:1,translateY:0,scale:1}}],mobileBounce:[{at:0,properties:{opacity:0,translateY:-30,scale:.9}},{at:.6,properties:{opacity:1,translateY:5,scale:1.05}},{at:1,properties:{opacity:1,translateY:0,scale:1}}],desktopComplex:[{at:0,properties:{opacity:0,translateY:-100,rotate:-45,scale:.5}},{at:.3,properties:{opacity:.5,translateY:-20,rotate:-15,scale:.8}},{at:.7,properties:{opacity:.9,translateY:10,rotate:5,scale:1.1}},{at:1,properties:{opacity:1,translateY:0,rotate:0,scale:1}}],customBounce:[{at:0,properties:{opacity:0,scale:0,rotate:-45}},{at:.4,properties:{opacity:.8,scale:1.3,rotate:10}},{at:.7,properties:{opacity:1,scale:.9,rotate:-5}},{at:1,properties:{opacity:1,scale:1,rotate:0}}],slideFlip:[{at:0,properties:{opacity:0,translateX:-100,rotateY:90}},{at:.6,properties:{opacity:.7,translateX:20,rotateY:-10}},{at:1,properties:{opacity:1,translateX:0,rotateY:0}}],waveEffect:[{at:0,properties:{opacity:0,translateY:25,scale:.8}},{at:.3,properties:{opacity:.5,translateY:"[-300vh]",scale:1.1}},{at:.6,properties:{opacity:.8,translateY:10,scale:.95}},{at:1,properties:{opacity:1,translateY:0,scale:1}}],typewriter:[{at:0,properties:{opacity:0,scaleX:0}},{at:.1,properties:{opacity:1,scaleX:.1}},{at:.3,properties:{scaleX:.4}},{at:.6,properties:{scaleX:.8}},{at:1,properties:{scaleX:1}}],responsiveFadeIn:[{at:0,properties:{opacity:0,translateY:-50,scale:.8}},{at:.5,properties:{opacity:.7,translateY:-10,scale:1.1}},{at:1,properties:{opacity:1,translateY:0,scale:1}}]}});
